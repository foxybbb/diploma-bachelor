\subsection{Overview of Mini Robot Features}

The active spread of robots after the mid-20th century led to the automation of almost all aspects of production processes, including assembly, welding, painting, quality control, and packaging. This also had a significant impact on logistics, warehousing, and distribution, where robotic systems are used for sorting, moving, and storing goods. Progress in mechanics, electronics, and digital devices led to the creation of various devices. This, in turn, contributed to progress, improving the quality and capabilities of previously developed solutions. One of the improvements in recent developments can be considered the emergence of mini manipulator robots.
The use of existing universal mini manipulator robots is an effective and rational solution due to their small size and parameters suitable for working with small parts and structures.

However, it should be noted that most of the work related to the assembly of small-sized parts is still performed by humans.

Improving the characteristics and parameters of mini manipulator robots is very relevant.
Mini manipulator robots are presented on the market, and developments are being carried out in this direction \citep{Li2022}. Examples of such robots include the "MotoMini" models from "Yaskawa", "Meca500" (Figure \ref{meca}) from "Mecademic", and others. The topic of mini robots is relevant, but it should be noted that the amount of information currently available on robots of this class is extremely small.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.35\textwidth]{Src/images/Meca500.jpg}
	\caption{Meca500 Robot Arm}
	\label{meca}
\end{figure}

Thanks to the small size of the entire structure, it is possible to create entire production lines right on the table. This opens up new possibilities for small-scale production and prototype development, where high precision and flexibility of processes are required. However, despite the advantages of mini manipulator robots, they have disadvantages. The main disadvantage is the danger of robots working together with humans. To organize the work of these robots, it is necessary to create special enclosed work areas to minimize potential risk, and working together with a human is deemed impossible.
This problem limits the application of mini robots, making them unsuitable for tasks requiring close interaction between humans and machines, especially when working with small objects that require operator participation. This also reduces the flexibility of production systems, as changing the configuration of the line may require significant time and resources to reconfigure the work area. The lack of collaboration is the main problem with these types of robots.

\subsection{Features of Collaborative Manipulator Robots}

A collaborative robot, or cobot, is an industrial type of robot equipped with a set of sensors and locking devices that help to avoid collisions with humans and various obstacles with high probability, even in cases of software malfunction. These devices are designed to work in close proximity to humans, not requiring placement in isolated work areas. They are also characterized by ease of programming, making them accessible for use by personnel without specialized skills.

According to the international standard ISO 10218 (parts 1 and 2) \citep{iso1021812011}, four main types of collaborative robots \citep{robotiqWhatDoes} are defined, which can be used for collaborative work with humans.
\begin{itemize}
	\item \textbf{With a safety-rated monitored stop.} Such collaborative robots can work autonomously according to the input control program, but when a human appears, the robot stops working. The robot's operation continues when the person leaves the work area;
	\item \textbf{With manual control.} In the presence of a person, such a collaborative robot performs his commands, given by hand. For example, a command can be given by touching a certain part of the body or recognizing hand movements at a distance. In the absence of a person, the collaborative robot can work autonomously if the necessary control program is entered;
	\item \textbf{With "computer vision".} Special sensors track the movement of people. When a person enters the work area, a reduced, safe speed is established. If he gets too close, the collaborative robot stops working;
	\item \textbf{With limited force.} These cobots do not sweep everything in their path when moving. If they encounter an obstacle, they stop, including when colliding with a person. Such collaborative robots can be used in close proximity to people.
\end{itemize}

ISO/TS 15066:2016 is the first of its kind document \citep{isoISOTS150662016}, establishing safety criteria for the use of collaborative robots. The development of this technical standard was carried out by the international ISO committee, which included specialists from 24 countries and representatives of leading robotics manufacturers, starting in 2010. The standard supplements the existing safety standards for industrial robots, recorded in ISO 10218-1 and ISO 10218-2, and sets specific requirements for safe interaction between industrial robots and humans in the work environment. ISO/TS 15066 provides methodological recommendations for conducting risk assessments related to collaborative use of robots and humans.

\textbf{Safety-rated monitored stop.} This method is used when the robot mainly works autonomously, but sometimes human intervention in the work area is required. For example, the robot may be processing a part, but at a certain point in the process, human intervention is needed to perform a task unavailable to the robot. In the event of a person entering the established safety zone, the robot stops, while the motors remain energized and ready to resume work. The advantage of the method is that after the person leaves the safety zone, the robot immediately continues its activity, eliminating the need for a full program reload, which could occur in the event of a complete stop. This method eliminates downtime in the robot's work, which would occur if people regularly moved through its work area;
\begin{itemize}
	\item The stop is ensured without loss of motor power (pause);
	\item The operator can interact with the robot;
	\item Automatic operation can resume when the person leaves the workspace;
	\item At any one time, either a person or a robot can move;
	\item Can be used with conventional industrial robots, but light safety barriers (laser rangefinders, photodetectors) need to be added.
\end{itemize}

\textbf{Hand guiding.}
This collaboration method is used for performing complex manipulations with heavy objects and can be adapted for use with traditional industrial robots by adding a special device. This device, usually a torque sensor installed on the robot's flange, allows sensing the force applied by the operator to the manipulator, thus providing the possibility of more precise control over the robot's actions.

\begin{itemize}
	\item The operator is in direct contact with the robot.
	\item The robot is under manual control.
	\item Both the human and the robot can move simultaneously (movements are controlled by the human).
	\item Conventional industrial robots can be used.
	\item Additional equipment is required (torque sensor).
\end{itemize}

\textbf{Speed and separation monitoring.}
In this approach to collaborative work, the robot's workspace is limited by light safety barriers, similar to the first type of collaboration, which monitor the location of people around. The main difference lies in the goal: while in the first case, the robot's main task is to stop when a person approaches, in this scenario, the goal is to allow parallel work of the person and the robot. The robot adapts its behavior according to pre-defined zones in its program: as the distance to a person decreases, the robot gradually reduces the speed of its movements and stops at critical proximity to prevent collision. When the person moves away, the robot resumes work and increases speed.
\begin{itemize}
	\item The robot's speed decreases as the person approaches.
	\item The robot stops when a collision with a person could occur.
	\item Both the human and the robot can move simultaneously.
	\item Can be used with conventional industrial robots, but light safety barriers (laser rangefinders, photodetectors) need to be added.
	\item Used for operations requiring frequent staff presence.
\end{itemize}

\textbf{Power and force limiting.} Torque sensors are located in the robot's "joints", which can detect a collision with a person. If the sensors detect forces exceeding permissible limits, the robot stops. These robots are also designed to dissipate forces over a wide surface in case of impact – this is why their body parts are often made with rounded shapes. Power and force limiting functionality is typically included in the standard software.

All the above forms of collaborative work can be used with conventional industrial robots, provided that additional devices are present. Such solutions are called collaborative robotic systems. The difference with a collaborative robot is that it may not use additional (external) safety devices – they are already built into it. Another important difference between collaborative robotic systems and collaborative robots is that in collaborative work, contact with a human is excluded. Meanwhile, a collaborative robot can contact the human body without harm to it. This is achieved by regulating power and force.

\subsection{Problem with Existing Mini Manipulator Robots}
A mini robot cannot become collaborative if power or force is limited for each link. To make the robot collaborative, changes need to be made to the robot's design.
The size of mini manipulator robots creates limitations for all system elements, and installing torque sensors is not the best solution, as they take up additional space in each link of the robot and complicate the mini robot's design. Other functional devices of the robot, which would ensure the features of a collaborative robot, need to be considered. The main part of the robot that provides the movement of links is the drive. Drive mechanisms are connected to the kinematic elements of the manipulator and perform movements.
The drive of any manipulator robot consists of:
\begin{itemize}
	\item An energy converter
	\item An electric motor
	\item A transmission mechanism
\end{itemize}

An electric motor is an electrotechnical device whose main function is to convert electrical energy into mechanical energy. To ensure the functions of a collaborative robot, it is necessary to choose a suitable type of electric motor.

The most commonly used motors in manipulator robots are DC motors, stepper motors, and servomotors.
\begin{itemize}
	\item DC motors come in brushed and brushless types. It is generally accepted that brushless DC motors have displaced brushed ones. A brushless DC motor is quieter, efficient at low speeds, and can maintain constant maximum torque, but this type of motor is complex to control \citep{medicaldesignbriefsBrushedVersus}.
	\item Stepper motors can control precise movement, have maximum torque at low speeds, and are simple to control. However, they have several drawbacks: they are noisy and relatively inefficient, and they overheat since they constantly consume maximum current, skip steps under high loads, and create additional vibration at low speeds of rotation \citep{Steppermotorvibrations}.
	\item Servomotors provide extremely precise movement. The disadvantages of using servomotors include the possibility of jitter when responding to feedback and the need for complex control logic, thus taking up a lot of space and adding complexity to the robot's design. Servomotors also assume the installation of a gearbox with a high reduction ratio, which also affects the dimensions and complexity of the robot itself.
\end{itemize}

The most suitable type of electric motor for a manipulator robot, as seen from table \ref{motorstab}, is the brushless DC motor due to its high torque at low speeds. Gimbal motors, which are brushless DC motors designed for use in camera gimbals, have very high torque at low speeds among this subtype of DC motors. This feature simplifies the choice of gearbox, as a high reduction ratio is not required, which simplifies the gearbox design and makes it more compact. A small reduction ratio creates the possibility of reverse control of the drive \citep{8867893}.

\begin{table}[H]
	\centering
	\caption{Table of characteristics of motors of various types}\label{motorstab}
	\begin{adjustbox}{width={\textwidth}}

		\fontsize{14pt}{12pt}\selectfont
		\begin{tabular}{|l|l|c|c|c|c|c|c|}
			\hline
			\textbf{Name}    & \textbf{Type} & \textbf{Power (W)} & \textbf{Torque (Nm)} & \textbf{Weight (g)} & \textbf{RPM} & \textbf{Reduction Ratio to 60 RPM} & \textbf{Torque at 60 RPM (Nm)} \\ \hline
			GM8112           & Gimbal        & 80                 & 0,89                 & 428                 & 420          & 7                                  & 2,45                           \\
			GM110-8T         & Gimbal        & 50                 & 0.35                 & 249                 & 209          & 4                                  & 1,4                            \\
			EC 45 Flat       & BLDC          & 50                 & 0.09                 & 110                 & 2360         & 39                                 & 3,53                           \\
			EC 45 Flat       & BLDC          & 70                 & 0.134                & 140                 & 2540         & 42                                 & 5,67                           \\
			Tarot 4008 330kv & BLDC          & 460                & 0.63                 & 80                  & 7920         & 132                                & 83,16                          \\
			Nema 8 x 38mm    & Step          & -                  & 0.03                 & 80                  & ~1200        & 20                                 & 0,6                            \\
			Nema 17 x 34mm   & Step          & -                  & 0.26                 & 230                 & ~1200        & 20                                 & 5,2                            \\
			Nema 23 x 76     & Step          & -                  & 1.9                  & 1200                & ~1200        & 20                                 & 38                             \\
			TSM4102          & Servo         & 50                 & 0.159                & 400                 & 3000         & 50                                 & 7,92                           \\ \hline
		\end{tabular}
	\end{adjustbox}

\end{table}


Also, according to the trends of recent research \citep{Sakama2022} fig \ref{magnets}, the specific power of brushless DC motors has increased more than tenfold over 20 years, and now brushless DC motors are electric motors with the highest specific power. The specific power of these motors increased after the appearance of permanent magnets with high magnetic energy. In particular, the appearance of the neodymium magnet.

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{Src/images/magnets.png}
	\caption{Changes in the specific power of electric motors over time \citep{Sakama2022}}
	\label{magnets}
\end{figure}
\subsection{Requirements for Electric Motor Control}

To ensure all the features of a collaborative robot, the most suitable type of electric motor, based on section 1.3, is the brushless DC motor. Regarding the mini robot, the Gimbal motors BLDC type is the most suitable. However, Gimbal motors have disadvantages inherent in all BLDC motors: the complexity of their control.
Options for controlling brushless DC motors:
\begin{itemize}
	\item Control with six-step commutation;
	\item Pulse Width Modulation (PWM);
	\item Control with vector modulation (FOC);
	\item Sensor and sensorless control.
\end{itemize}

When choosing a control method, it was necessary to consider the need for smooth control of speed, acceleration, and motor torque.
Control with vector modulation is the most suitable method for controlling the electric motor axis of a mini manipulator robot. FOC provides high efficiency and smooth operation by independently controlling the magnetic flux and torque of the motor. This is achieved by converting the three-phase signal into a two-phase one in a rotating coordinate system, which is used for further control. Vector regulation requires determining the current position of the motor rotor using angle sensors.

When developing a control system for a collaborative mini robot, it is necessary to consider not only the differences in drive control but the control system as a whole. Therefore, it is necessary to make changes to the entire control system of the mini robot.

\subsection{Defining Functions and Technical Specifications for the Control System of a Collaborative Mini Robot}

As mentioned earlier, any manipulator robot consists of various systems: electronic, mechanical, computational, sensory, and others. The robot's control system must organize work between them and ensure the operation of the manipulator robot according to the following requirements:
\begin{itemize}
	\item Precise movement control, smooth control of the robot's movements with high accuracy, including the synchronization of all joints and mechanisms;

	      vbnet

	\item Implementation of the given algorithms and tasks, includes tasks of the sequence of movements and operations of the robot's actions;

	\item Processing of sensory data, accurately process data from sensors to adapt to changes in the environment;

	\item Interaction with the operator, possibilities for manual control and programming;

	\item Integration with other systems, the robot to be not only one element in production, used together with conveyor line systems.

\end{itemize}

The control system of a collaborative mini robot does not differ much from the requirements of a regular industrial manipulator, but it must ensure functions:
\begin{itemize}
	\item Calculation of the motion trajectory, solving kinematic tasks;
	\item Precise and smooth movement control of the motor using a vector control algorithm with feedback;
	\item Control of speed, acceleration, motor torque;
	\item Limitation of minimum and maximum parameters of speed, acceleration, and position, current voltage;
	\item Torque control;
	\item Real-time processing of data from various sensors;
	\item Visual display of the robot's state;
	\item Possibility of integration with other systems;
	\item Monitoring of temperature and device shutdown at high temperatures.
\end{itemize}

Developing a control system for a mini manipulator robot is impossible without considering the design of the robot itself. Based on the data performed in section 1.1. It was determined that the control system of a collaborative mini robot manipulator using Gimbal motors should have technical parameters corresponding to the characteristics of existing mini robots. The robot design is a 6-axis manipulator robot: six degrees of freedom are necessary to approximate the possible movements of the human hand. For the development of the control system of the mini manipulator robot, the most commonly encountered kinematic structure is shown in figure \ref{Kin}.


Parameters of the kinematic structure:


\begin{figure}[H]
	\centering
	\input{Src/extra/KinStructureTikZ.tex}
	\caption{Kinematic structure of a mini robot}
	\label{Kin}
\end{figure}

\begin{itemize}
	\item d1, d2, d3, d4, d5 - distances between links;
	\item θ1, θ2, θ3, θ4, θ5, θ6 - angles of the links;
	\item a1, a2 - lengths of the links;
	\item X0, Y0, Z0 - base coordinates;
	\item X6, Y6, Z6 - tool coordinates.
\end{itemize}

The existing parameters from the mini manipulator robot MotoMini from "Yaskawa" were taken as the basis for the implementation of the control system:
% $$ a3 = 0mm; d3 = 165mm, d4 = 40mm, d5 = 0mm $$
Technical specifications:
\begin{itemize}
	\item Number of axes – 6 axes;
	\item Repeatability 0.02 mm;
	\item Maximum operating temperature limit: 80 °C;
	\item Limiting the maximum motor current to 25 A;
	\item The size of the control system should not exceed 300x300mm;
	\item The mass of the control system should not exceed 5 kg;
	\item Minimum axis rotation speed not less than 150 °/s;
	\item Average power consumption <200W;
	\item Operating voltage 24V.
	\item Angle limitations:
	      \begin{itemize}
		      \item[$\circ$] Axis 1 from -180° to +180°;
		      \item[$\circ$] Axis 2 from -90° to +90°;
		      \item[$\circ$] Axis 3 from -90° to +90°;
		      \item[$\circ$] Axis 4 from -180° to +180°;
		      \item[$\circ$] Axis 5 from -180° to +180°;
		      \item[$\circ$] Axis 6 from -360° to +360°;
	      \end{itemize}
\end{itemize}