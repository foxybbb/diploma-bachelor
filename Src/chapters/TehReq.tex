\subsection{Обзор особенностей мини роботов}

Активное распространение роботов после середины 20 века привело к автоматизации почти всех аспектов производственных процессов, включая сборку, сварку, покраску, контроль качества и упаковку. Это также оказало значительное влияние на логистику, складское хозяйство
и дистрибуцию, где роботизированные системы используются для сортировки, перемещения и
хранения товаров. Прогресс в области механики, электроники и цифровых устройств, привел к
созданию всевозможных устройств. Это в свою очередь поспособствовало прогрессу, повышению качества и возможностей ранее разработанных решений. Одним из улучшений недавних разработок можно считать появление мини роботов манипуляторов.

Хотя стоит отметить, что большинство работ связанных со сборкой деталей небольших размеров до сих пор выполняются людьми. Использование существующих универсальных мини роботов манипуляторов является эффективным и рациональным решением, ввиду их небольших размеров и параметров соответствующих для работы с мелкими деталями и конструкциями. 

Улучшение характеристик и параметров мини роботов манипуляторов является очень актуально.
Мини роботы манипуляторы представлены на рынке и разработки ведутся в данном направлении \citep{Li2022}. Примером таких роботов могут считаться роботы моделей «MotoMini» от компании «Yaskawa», «Meca500» (Рисунок \ref{meca}) от компании «Mecademic»  и другие. Тема мини роботов является актуальной, однако стоит отметить, количество информации, на данный момент, о роботах этого класса крайне небольшое.

\begin{figure}[H]
	\centering?
	\includegraphics[width=0.3\textwidth]{Src/images/Meca500.jpg}
	\caption{Meca500 Robot Arm}
	\label{meca}
\end{figure}

Благодаря маленькому размеру всей конструкции, возможно создавать целые производственные линии прямо на столе. Это открывает новые возможности для мелкосерийного производства и разработки прототипов, где требуется высокая точность и гибкость процессов. Однако несмотря на преимущества мини-роботов манипуляторов, они обладают недостатками. Главным недостатком является опасность работы роботов совместно с людьми. Для организации работы данных роботов необходимо создавать специальные закрытые рабочие зоны, для минимизации возможного риска, а работа совместно с человеком представляется невозможной.
Эта проблема ограничивает область применения мини-роботов, делая их непригодными для задач, где требуется тесное взаимодействие между человеком и машиной особенно при работе с мелкими предметами, требующие участия оператора. Также это снижает гибкость производственных систем, поскольку для изменения конфигурации линии может потребоваться значительное время и ресурсы на переустройство рабочей зоны. Отсутствие коллаборативности является основной проблемой данных типов роботов.


\subsection{Особенности коллаборативных роботов манипуляторов}

Коллаборативные роботы или короботы - это индустриальный тип робота, оборудованный набором датчиков и фиксирующих устройств, которые помогают с высокой точностью избегать столкновений с людьми и различными препятствиями, даже в случаях неисправности программного обеспечения. Эти устройства разработаны для работы в непосредственной близости с человеком, не требуя размещения в изолированных рабочих зонах. Они так же отличаются простотой программирования, что делает их доступными для использования персоналом без специализированных навыков.

Согласно международному стандарту ISO 10218 (части 1,2) \citep{iso1021812011} определены четыре основных типа коллаборативных роботов \citep{robotiqWhatDoes}, которые могут использоваться для совместной работы с человеком.
\begin{itemize}
	\item  \textbf{С остановочным защитным механизмом.} Такие коллаборативные роботы способны работать автономно по введенной управляющей программы, но при появлении человека робот прекращает работу. Работа робота продолжается, когда человек покидает рабочую зону;
	\item \textbf{С ручным управлением.} В присутствии человека такой коллаборативный робот выполняет его команды, подаваемые рукой. Например, команда может подаваться путем касания рукой до определенной части корпуса или распознает движение рук на расстоянии. При отсутствии человека коллаборативный робот может работать автономно, если введена необходимая управляющая программа;
	\item  \textbf{С «компьютерным зрением».} Специальные датчики отслеживают движение людей. При входе человека в рабочую зону устанавливается пониженная, безопасная скорость. Если он приближается слишком близко, то коллаборативный робот останавливает работу;
	\item \textbf{С ограниченной силой.} Эти короботы при перемещении не сметают все по пути. Если они наталкиваются на препятствие, то останавливаются, в т. ч. при столкновении с человеком. Такие коллаборативные роботы могут использоваться в непосредственной близости от людей.
\end{itemize}


ISO/TS 15066:2016 представляет собой первый в своем роде документ\citep{isoISOTS150662016}, устанавливающий критерии безопасности для использования коллаборативных роботов. Разработка этого технического стандарта была осуществлена международным комитетом ISO, в который входили специалисты из 24 стран и представители ведущих производителей робототехники, начиная с 2010 года. Стандарт служит дополнением к уже существующим нормам безопасности промышленных роботов, зафиксированным в ISO 10218-1 и ISO 10218-2, и устанавливает конкретные требования к безопасному взаимодействию между промышленными роботами и людьми в рабочей среде. ISO/TS 15066 предлагает методические рекомендации для проведения оценки рисков, связанных с коллаборативным использованием роботов и человека.


\textbf{Контролируемая остановка (Safety-rated monitored stop).} Этот метод применяется, когда робот в основном работает автономно, однако иногда требуется вмешательство человека в рабочую зону. К примеру, робот может выполнять обработку детали, но в определенный момент процесса необходимо человеческое вмешательство для выполнения задачи, недоступной роботу. В случае входа человека в установленную зону безопасности, робот останавливается, при этом моторы остаются под напряжением и готовы к возобновлению работы. Достоинства метода, после выхода человека из зоны безопасности, робот мгновенно продолжает свою деятельность, исключая потребность в полной перезагрузке программы, что могло бы произойти при полной остановке. Такой метод исключает простои в работе робота, которые бы возникали, если бы люди регулярно перемещались через его рабочую зону;
\begin{itemize}
	\item Остановка обеспечивается без потери мощности двигателей (пауза);
	\item Оператор может взаимодействовать с роботом;
	\item Автоматическая работа может возобновиться, когда человек покидает рабочее пространство;
	\item В один момент времени может двигаться либо человек, либо робот;
	\item Может использоваться с обычными промышленными роботами, но нужно добавить световые барьеры безопасности (лазерные дальномеры, фотодетекторы).
\end{itemize}

\textbf{Ручное ведение (Hand guiding).}
Этот метод коллаборации применяется при выполнении сложных манипуляций с тяжелыми предметами и может быть адаптирован для использования с традиционными промышленными роботами при добавлении специального устройства. Это устройство, обычно датчик момента, установленный на фланце робота, позволяет ощущать силу, прикладываемую оператором к манипулятору, обеспечивая таким образом возможность более точного управления действиями робота.

\begin{itemize}
	\item Оператор находится в непосредственном контакте с роботом.
	\item Робот находится под ручным управлением.
	\item И человек, и робот могут двигаться одновременно (движения контролируются человеком).
	\item Могут использоваться обычные промышленные роботы.
	\item Требуется дополнительное оборудование (датчик момента)
\end{itemize}

\textbf{Контроль скорости и разделения (Speed and separation monitoring).}
В этом подходе к совместной работе рабочее пространство робота ограничено световыми барьерами безопасности, аналогично первому типу коллаборации, которые отслеживают расположение людей вокруг. Основное отличие состоит в цели: в то время как в первом случае основной задачей робота является остановка при приближении человека, в данном сценарии целью является возможность параллельной работы человека и робота. Робот адаптирует свое поведение в соответствии с предварительно заданными зонами в его программе: с уменьшением дистанции до человека робот постепенно снижает скорость своих движений и останавливается при критическом сближении для предотвращения столкновения. Когда человек удаляется, робот возобновляет работу и увеличивает скорость.
\begin{itemize}
	\item Скорость робота уменьшается, по мере приближения человека.
	\item Робот останавливается, когда может произойти столкновение с человеком.
	\item Человек и робот могут перемещаться одновременно.
	\item Может использоваться с обычными промышленными роботами, но нужно добавить световые барьеры безопасности (лазерные дальномеры, фотодетекторы).
	\item Используется для операций, требующих частого присутствия персонала
\end{itemize}

\textbf{Ограничение мощности и усилия (Power and force limiting).} В «суставах» робота находятся датчики момента, которые могут определить факт столкновения с человеком. Если датчики обнаруживают превышение допустимых усилий, робот останавливается. Эти роботы также предназначены для рассеивания сил на широкой поверхности, в случае удара – именно поэтому детали их корпуса чаще всего сделаны с округлыми формами. Функционал по ограничению мощности и силы, как правило, входит в штатное программного обеспечения.

Все описанные выше формы совместной работы могут использоваться с обычными промышленными роботами, при условии наличия дополнительных устройств. Такие решения называются: коллаборативные робототехнические системы. Отличие коллаборативного робота в том, что он может не использовать дополнительные (внешние) устройства обеспечения безопасности – они уже встроены в него. Еще одно важное отличие коллаборативных робототехнических систем от коллаборативных роботов состоит в том, что при совместной работе исключается контакт с человеком. А вот коллаборативный робот может контактировать с телом человека без вреда для него. Это достигается за счет регулирования мощности и усилия.

\subsection{Проблема существующих мини роботов манипуляторов}
Мини робот не может стать коллаборативным если ограничить мощность или силу для каждого звена. Для того что бы робот являлся коллаборативным необходимо производить изменения в конструкции самого робота.
Размер мини роботов манипуляторов создает ограничения для всех элементов системы, установка датчиков момента силы не является лучшим решением, так как занимают дополнительное пространство в каждом звене робота и усложняют конструкцию мини робота. Требуется рассмотреть другие функциональные устройства робота, которые позволят обеспечить особенности коллаборативного робота. Основная часть робота которая обеспечивает передвижения звеньев, является приводы. Приводные механизмы связаны с кинематическими элементами манипулятора и выполняют перемещения.
Привод любого робота манипулятора состоит из:
\begin{itemize}
	\item Преобразователя энергии
	\item Электродвигателя
	\item Передаточного механизма
\end{itemize}

Электродвигатель —  электротехническое изделие, основной функцией которого является преобразование энергии электрической в механическую. Для обеспечения функций коллаборативного робота, необходимо выбрать подходящий тип электродвигателя.

Наиболее часто используемые двигатели, которые используются в роботах манипуляторах двигатели: постоянного тока, шаговые и сервоприводы.
\begin{itemize}
	\item Двигатели постоянного тока бывают коллекторные и бесщеточные. Принято считать, что бесщеточные двигатели постоянного тока вытеснили коллекторные. Бесщеточный двигатель постоянного тока тише, эффективен на низких оборотах и может поддерживать постоянный максимальный крутящий момент, но данный тип двигателя сложен в управлении\citep{medicaldesignbriefsBrushedVersus}.
	\item Шаговые двигатели могут контролировать точное движение, имеют максимальный крутящий момент на низких скоростях и просты в управлении. Однако у них есть несколько недостатков: они шумны и относительно неэффективны, а также перегреваются, поскольку постоянно потребляют максимальный ток, пропускают ступени при высоких нагрузках и за "шаговых" перемещений создают дополнительную вибрацию на низких скоростях вращения\citep{Steppermotorvibrations}.
	\item Серводвигатели обеспечивают чрезвычайно точное движение. К недостаткам использования серводвигателей относятся возможность их джиттера при реакции на обратную связь и необходимость сложной логики управления, таким образом занимают много места и добавляют сложности в конструкцию робота. Так же для серводвигателей предполагается установка редуктора с большой степенью передаточного отношения, что так же влияет на габариты и сложности самого робота.
\end{itemize}


Наиболее подходящим типом электродвигателя для робота манипулятора является бесщеточный двигатель постоянного тока как видно из таблицы \ref{motorstab}, за счет большого момента на низких оборотах, двигатели Gimbal, которые являются бесщеточные двигатели постоянного тока, ориентированы под использование карданных подвесов камер, у данных подтипа двигателей постоянного тока очень высокий момент при низких оборотах. Данная особенность облегчает выбор редуктора, не требуется высокая степень редукции, это упрощает конструкцию самого редуктора и делает его более компактным. Небольшая степень передаточного отношения создаёт возможность обратного управления приводом \citep{8867893}.

\begin{table}[H]
	\centering
	\caption{Талица характеристик двигателей различных типов}\label{motorstab}
	\begin{adjustbox}{width={\textwidth}}

		\begin{tabular}{|l|l|c|c|c|c|c|c|}
			\hline
			\textbf{Name}    & \textbf{Type} & \textbf{Power (W)} & \textbf{Torque (Nm)} & \textbf{Weight (g)} & \textbf{RPM} & \textbf{Reduction Ratio to 60 RPM} & \textbf{Torque at 60 RPM (Nm)} \\ \hline
			GM8112           & Gimbal        & 80                 & 0,89                 & 428                 & 420          & 7                                  & 2,45                           \\
			GM110-8T         & Gimbal        & 50                 & 0.35                 & 249                 & 209          & 4                                  & 1,4                            \\
			EC 45 Flat       & BLDC          & 50                 & 0.09                 & 110                 & 2360         & 39                                 & 3,53                           \\
			EC 45 Flat       & BLDC          & 70                 & 0.134                & 140                 & 2540         & 42                                 & 5,67                           \\
			Tarot 4008 330kv & BLDC          & 460                & 0.63                 & 80                  & 7920         & 132                                & 83,16                          \\
			Nema 8 x 38mm    & Step          & -                  & 0.03                 & 80                  & ~1200        & 20                                 & 0,6                            \\
			Nema 17 x 34mm   & Step          & -                  & 0.26                 & 230                 & ~1200        & 20                                 & 5,2                            \\
			Nema 23 x 76     & Step          & -                  & 1.9                  & 1200                & ~1200        & 20                                 & 38                             \\
			TSM4102          & Servo         & 50                 & 0.159                & 400                 & 3000         & 50                                 & 7,92                           \\ \hline
		\end{tabular}
	\end{adjustbox}

\end{table}


Так же исходя из тенденций последних исследований \citep{Sakama2022} рис \ref{magnets}, удельная мощность бесщеточных двигателей постоянного тока, увеличилась более чем в десять раз за 20 лет, и теперь бесщеточные двигатели постоянного тока являются электродвигателями с самой высокой удельной мощностью. Удельная мощность данных двигателей увеличилась после появления постоянных магнитов с высокой магнитной энергией. В частности, появление неодимового магнита.

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{Src/images/magnets.png}
	\caption{Изменение удельной мощности в электрических двигателях во времени \citep{Sakama2022}}
	\label{magnets}
\end{figure}

\subsection{Требования к управлению электродвигателя}

Наиболее подходящий тип электродвигателя исходя из раздела 1.3 является бесщеточный двигатель постоянного тока, для обеспечения всех особенностей коллаборативного робота. Касательно мини робота, тип BLDC двигателя Gimbal motors наиболее подходящим. Но Gimbal motors обладает недостатками, которые присущи всем BLDC двигателям, сложность в управлении. 
Варианты управления бесщёточными двигателями постоянного тока:
\begin{itemize}
	\item Управление с шестистепенной коммутацией;
	\item Широтно-импульсная модуляция (PWM);
	\item Управление с векторной модуляцией (FOC);
	\item Датчиковое и бездатчиковое управление.
\end{itemize}

При выборе метода управления требовалось учитывать необходимость плавного управления скоростью, ускорением и моментом двигателя. 
Управление с векторной модуляцией является наиболее подходящим методом для управления электродвигателем осью мини робота манипулятора. FOC обеспечивает высокую эффективность и плавность работы за счет независимого управления магнитным потоком и крутящим моментом двигателя. Достигается за счет преобразования трехфазного сигнала в двухфазный во вращающейся системе координат, который используется для дальнейшего управления. Для векторного регулирования необходимо определять текущее положение ротора двигателя с использованием датчиков угла поворота.

При разработке системы управления для коллаборативного мини робота, необходимо учитывать не только различия  в управлении приводов, но саму систему управления в целом. Поэтому необходимо производить изменение всей системы управления мини робота. 


\subsection{Определение функций и технических характеристик системы управления для мини роботом}

Как уже упоминалось ранее любой робот манипулятор состоит из различных систем: электронной, механической, вычислительной, сенсорной и других. Система управления робота должна организовывать работу между ними и обеспечить функционирование робота манипулятора по следующим требованиям:
\begin{itemize}
	\item Точное управление движением, плавное управление движениями робота с
	      большой точностью, включая синхронизацию всех суставов и механизмов;

	\item Реализация заданных алгоритмов и задач, включает в себя задачи
	      последовательности движений и операций действий робота;

	\item Обработка сенсорных данных, точно обрабатывать данные с датчиков для
	      адаптации к изменениям окружающей среды;

	\item Взаимодействие с оператором, возможности для ручного управления и
	      программирования;

	\item Интеграция с другими системами, робот являться не только одним
	      элементом на производстве, использование совместно с системами конвейерных
	      линий.
\end{itemize}


Система управления коллаборативного мини робота не сильно отличается от требований обычного промышленного манипулятора, но должна обеспечивать функциям:
\begin{itemize}
	\item Расчёта траектории движения, решение кинематических задач;
	\item Точное и плавное управление движением двигателем используя алгоритм векторного регулирования c обратной связью;
	\item Управление скоростью, ускорением, моментом электродвигателя;
	\item Ограничение минимальных и максимальных параметров скорости, ускорения и позиции, тока напряжения;
	\item Управление моментом;
	\item Обработка данных с различных датчиков в реальном времени;
	\item Визуальное отображение состояния робота;
	\item Возможность интеграции с другими системами;
	\item Мониторинг температуры и отключение устройства при высоких температурах.
\end{itemize}

Разрабатывать систему управления для мини робота манипулятора невозможно в отрыве от конструкции самого робота. На основе данных, выполненного в разделе 1.1. Было определённо, что система управления коллаборативного мини роботом манипулятора с использованием Gimbal motors, должна иметь технические параметры, соответствующие характеристикам существующих мини роботов. Конструкция робота - 6 осевой робот манипулятор: шесть степеней свободы необходимо для приближенной имитации возможных движений человеческой руки. Для разработки системы управления мини роботом манипулятором взята наиболее часто встречающая кинематическая структура, приведена на рисунке \ref{Kin}.


\begin{figure}[H]
	\centering
	\input{Src/extra/KinStructureTikZ.tex}
	\caption{Кинематическая структура мини робота}
	\label{Kin}
\end{figure}

Параметры кинематической структуры:

\begin{itemize}
	\item d1, d2 , d3 , d4 , d5 - расстояния между звеньями;
	\item θ1, θ2, θ3, θ4, θ5, θ6 - углы звеньев;
	\item a1, a2 - длины звеньев;
	\item X0, Y0 , Z0 - базовые координаты;
	\item X6, Y6 , Z6 - координаты инструмента.
\end{itemize}
За основу реализации системы управления были взяты существующие параметры от мини-робота манипулятора MotoMini от компании "Yaskawa":
$$ d1 = 171mm; d2 = 165mm, a1 = 20mm, 
a3 = 0mm; d3 = 165mm, d4 = 40mm, d5 = 0mm $$

Технические характеристики:
\begin{itemize}
	\item Количество осей – 6 осей;
	\item Повторяймость 0.02 мм;
	\item Ограничение максимальной рабочей температуры: 80 °С;
	\item Ограничение максимального тока двигателя до 25 A;
	\item Размер системы управления не должна превышать размера 300x300mm;
	\item Масса системы управления, не должна превышать 5 кг;
	\item Минимальная скорость поворота оси не менее 150 °/s;
	\item Средняя мощность потребления <200W;
	\item Рабочее напряжение 24В.
	\item Ограничения углов:
	\begin{itemize}
		\item[$\circ$] Ось 1 от -180° до +180°;
		\item[$\circ$] Ось 2 от -90° до +90°;
		\item[$\circ$] Ось 3 от -90° до +90°;
		\item[$\circ$] Ось 4 от -180° до +180°;
		\item[$\circ$] Ось 5 от -180° до +180°;
		\item[$\circ$] Ось 6 от -360° до +360°;
	\end{itemize}

\end{itemize}

